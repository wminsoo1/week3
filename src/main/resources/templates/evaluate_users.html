<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Evaluate Users</title>
</head>
<body>

<h2>Project Information</h2>
<table border="1">
    <thead>
    <tr>
        <th>Project Title</th>
        <th>Date</th>
        <th>Project Description</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td id="projectTitle"></td>
        <td id="projectDate"></td>
        <td id="projectDescription"></td>
    </tr>
    </tbody>
</table>

<h2>Evaluations</h2>
<form th:action="@{/asd}" method="post">
    <table border="1">
        <thead>
        <tr>
            <th>Evaluator</th>
            <th>Score</th>
        </tr>
        </thead>
        <tbody id="evaluationTableBody">
        <!-- Dynamic content will be inserted here -->
        </tbody>
    </table>
    <button type="submit">평가 완료</button>
</form>

<script>
    // AJAX 요청 수행하는 함수
    function fetchData() {
        // jQuery를 사용하여 AJAX 요청을 수행합니다 (원하신다면 네이티브 JavaScript를 사용할 수도 있습니다)
        $.ajax({
            type: 'POST',
            url: '/evaluatees?projectId=' + /* 여러분의 프로젝트 아이디 변수 */,
            success: function (data) {
                // 프로젝트 정보 설정
                document.getElementById("projectTitle").innerText = data.project.projectTitle;
                document.getElementById("projectDate").innerText = data.project.date;
                document.getElementById("projectDescription").innerText = data.project.projectDescription;

                // 평가 테이블 채우기
                var evaluationTableBody = document.getElementById("evaluationTableBody");
                data.evaluation.forEach(function (eval) {
                    var row = document.createElement("tr");
                    var evaluatorCell = document.createElement("td");
                    var scoreCell = document.createElement("td");

                    evaluatorCell.innerText = eval.evaluatee.userName;
                    scoreCell.innerHTML = '<input type="number" value="' + eval.score + '" placeholder="점수를 입력하세요"/>';

                    row.appendChild(evaluatorCell);
                    row.appendChild(scoreCell);
                    evaluationTableBody.appendChild(row);
                });
            }
        });
    }

    // 페이지 로딩 시 데이터를 가져오도록 설정
    window.onload = fetchData;
</script>

</body>
</html>
